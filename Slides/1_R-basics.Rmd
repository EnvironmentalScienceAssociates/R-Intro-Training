---
title: "Introduction to R for Excel Users"
author: 
  - "Travis Hinkelman"
  - "Taylor Spaulding"
date: "2020-11-20"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(tidyverse)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_duo_accent(
  primary_color = "#699CC6",
  secondary_color = "#F9A134",
  inverse_header_color = "#FFFFFF"
)
```

## Motivation

.pull-left[
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7f/Microsoft_Office_Excel_%282018%E2%80%93present%29.svg/500px-Microsoft_Office_Excel_%282018%E2%80%93present%29.svg.png" style="height:300px"> 

]
.pull-right[
<img src="https://www.r-project.org/logo/Rlogo.png"  style="height:300px">  
]

---
## Motivation

.pull-left[
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7f/Microsoft_Office_Excel_%282018%E2%80%93present%29.svg/500px-Microsoft_Office_Excel_%282018%E2%80%93present%29.svg.png" style="height:300px"> 

]
.pull-right[
<img src="https://tidyverse.tidyverse.org/articles/tidyverse-logo.png"  style="height:300px; padding-left:80px">  
]

---
## Rterm

<img src="/Slides/img/Rterm.png"> 

---
## RGui

```{r echo = TRUE}
knitr::include_graphics("/Slides/img/RGui.png", error = FALSE)
```

---
## RStudio

knitr::include_graphics("Slides/img/RStudio.png", error = FALSE)

---
## Data Structures

One advantage of Excel is that the data are front and center. Feels tangible.

--

Important to feel comfortable with R's functions for showing the shape and structure of your data, e.g., `length`, `dim`, `nrow`, `head`, `View`, `glimpse`, `summary`.

--

A good mental model of the shape and structure of your data helps you understand the code that you need to write to analyze that data.

--

R has four main data structures: vector, matrix/array, list, and data frame.

--

We will focus on vectors and data frames.

---

## Vectors

Combine elements into a vector with `c` (for **c**ombine or **c**oncatenate).

```{r echo = TRUE}
c(1, 2, 3)
```
--
```{r echo = TRUE}
c("a", "b", "c")
```
--
```{r echo = TRUE}
c(TRUE, FALSE, TRUE)
```

---

## Vectors

All elements of a vector must be the same type. Type coercion is implicit and a common source of confusion.

```{r echo = TRUE}
c(1, 2, "a", "b")
```
--
```{r echo = TRUE}
c(1, 2, TRUE, FALSE)
```
--
```{r echo = TRUE}
c("a", "b", TRUE, FALSE)
```

---

## Vectors

Create numeric sequences with `:` or `seq`.

```{r echo = TRUE}
1:5
```
--
```{r echo = TRUE}
2:-3
```
--
```{r echo = TRUE}
seq(from = 1, to = 5, by = 1)
```
--
```{r echo = TRUE}
seq(3, 1, -0.5)
```

---

## Vectors

Many operations in R are "vectorized."

```{r echo = TRUE}
seq(2, 10, 2) / 2
```
--
```{r echo = TRUE}
sqrt(c(1, 4, 9, 16))
```
--
```{r echo = TRUE}
0:5 + 10:15
```

---

## Data Frames

Data frames are tabular data structures where each column is a vector.

```{r echo = TRUE}
data.frame(Integer = 1L:3L,
           Double = c(1, 2.5, 3),
           Logical = c(TRUE, FALSE, TRUE),
           Character = c("strings", "better", "name"),
           Factor = as.factor(c("factors", "are", "special")))
```

---

## Data Frames

Examine data frame structure with `glimpse`.

```{r echo = TRUE}
d <- data.frame(Integer = 1L:3L,
                Double = c(1, 2.5, 3),
                Logical = c(TRUE, FALSE, TRUE),
                Character = c("strings", "better", "name"),
                Factor = as.factor(c("factors", "are", "special")))
glimpse(d)
```

---

## Data Frames

Elements of shorter length are recycled. Common source of confusion.

```{r echo = TRUE}
data.frame(Length4 = 1:4,
           Length2 = 1:2,
           Length1 = 1)
```

---

## Data Frames

Recycling fails when longer vector is not a multiple of shorter vector.

```{r echo = TRUE, error=TRUE}
data.frame(Length4 = 1:4,
           Length3 = 1:3)
```

---

## Data Frames

Use `head` to preview data frame in console.

```{r echo = TRUE}
head(data.frame(x = 1:100, y = sample(1:100), z = rnorm(100)), n = 10)
```

---

## Tibbles

Tibbles are data frames with some special behavior.

```{r echo = TRUE, error=TRUE}
data.frame(Number = 1:2,
           Times2 = Number*2)
```
--
```{r echo = TRUE}
tibble::tibble(Number = 1:2,
               Times2 = Number*2)
```

---

## Tibbles

By default, data frames truncate printing at 333 rows. Always use head if you don't know how big a data frame is.

```{r echo = TRUE, error=TRUE}
data.frame(x = 1:500, y = sample(1:500), z = rnorm(500))
```

---

## Tibbles

Tibbles have enhanced (and opinionated) printing behavior.

```{r echo = TRUE, error=TRUE}
tibble::tibble(x = 1:500, y = sample(1:500), z = rnorm(500))
```

---

## Reading Data

